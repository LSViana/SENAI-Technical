<!DOCTYPE html>
<html lang="en">

<head>
    <title></title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="./css/style.css">
</head>

<body>
    <div id="timeline">
        <h1>Brenda's Travel Report <span><3</span></h1>
        <div id="tl-border">
            <div id="tl-loader"></div>
        </div>
        <h2>Started</h2>
    </div>
    <div id="tasks">
        <ul>
            <li>
                <div></div>
                <p>12/15:
                    <span>The <span>leaving</span>.</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/16:
                    <span>My <span>hug</span> waits for yours!</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/17:
                    <span>Your <span>feet</span> are so awaited.</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/18:
                    <span><span>Starred</span> messages become more useful.</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/19:
                    <span>The <span>memories</span> come out greatly!</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/20:
                    <span>Your <span>sweetness</span> affects me a little more!</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/21:
                    <span>I am waiting for you to remember my <span>wishes</span>!</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/22:
                    <span>There's only <span>one</span> month left.</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/23:
                    <span>Your heat has no <span>boundaries</span>.</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/24:
                    <span>Something <span>great</span>'s just coming!</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/25:
                    <span>
                        <span>Merry Christmas</span>, my love!</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/26:
                    <span>Each time nearer of
                        <span>us</span>!</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/27:
                    <span>How about <span>72 hours</span>?</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/28:
                    <span>My way persists being called
                        <span>Brenda Rocha</span>.</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/29:
                    <span>The <span>messages</span> aren't enough anymore.</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/30:
                    <span>The deep thoughts come back to <span>save</span> days!</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>12/31:
                    <span><span>Unforgettable</span> friend is leaving us.</span>
                </p>
            </li>
            <li>
                <div></div>
                <p>01/01:
                    <span>
                        <span>Happy New Year</span>, sweetie!</span>
                </p>
            </li>
        </ul>
    </div>
</body>
<script>
    var tlLoader = document.getElementById("tl-loader");
    var dateText = document.querySelector("#timeline h2");
    var notes = document.querySelectorAll("#tasks ul li");
    var doneTicks = document.querySelectorAll("#tasks ul li div");
    var now = new Date();
    var startDate = new Date("2017-12-15");
    var endDate = new Date("2018-01-01");
    var days = new Date((endDate - startDate)).getTime() / (1000 * 60 * 60 * 24);
    var spentDays = new Date((endDate - now)).getTime() / (1000 * 60 * 60 * 24);
    var perc = Math.ceil((days - spentDays) / days * 100);
    // Loading month's bar and date label
    var i = 0;
    var interval = 16;
    var originalText = now.toLocaleDateString();
    var dateWidth = dateText.clientWidth;
    var intervalId = setInterval(animateTimeline, interval);
    function animateTimeline() {
        if(i + 0.05 > perc)
            clearInterval(intervalId);
        tlLoader.style.width = "calc(" + i + "% - 16px)";
        dateText.style.paddingLeft = "calc(-" + (dateWidth / 2) + "px + " + i + "% * 0.8)";
        dateText.style.opacity = i / perc;
        Array.prototype.forEach.call(doneTicks, function(el) {
            el.style.opacity = i / perc;
        });
        i += Math.sin(1 - i / perc);
        var textPerc = Math.ceil(i / perc * originalText.length);
        var subText = originalText.substr(0, textPerc);
        dateText.textContent = subText;
    };
    // Loading achievements
    for(var i = 0; i < notes.length; i++) {
        var note = notes[i];
        var currDate = new Date(startDate.valueOf());
        currDate.setDate(startDate.getDate() + i);
        if(currDate.getTime() + (1000 * 60 * 60 * 24) < now.getTime()) {
            var d = note.children.item(0);
            d.classList.add("done");
        }
    }
</script>

</html>